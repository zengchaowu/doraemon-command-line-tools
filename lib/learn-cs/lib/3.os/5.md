# 线程

线程的产生是因为进程无法同时执行多个不同的任务，因为CPU是顺序执行代码的，例如同时执行图像处理和网络请求。而现代应用中，一个应用程序需要同时进行大量的不同的任务，所以才有了线程。

现代CPU，CPU调度的最小单元变成了线程，CPU使用时间片轮转方式（有优先级等的考虑）分时执行线程。每个线程中运行不同的二进制代码，从而实现多任务并发。出现线程后，进程只作为分配资源的基本单元，也就是所有线程共享同一块进程空间，共享所有分配给进程的IO资源等。线程切换不需要切换进程上下文，所以更快。


# 线程属性
线程也有线程ID和线程控制块TCB
线程几乎不拥有系统资源。
线程间通讯不需要系统干预。

# 线程种类
1. 用户级线程
用户定义出来的线程，对于操作系统来说并不可见。操作系统还是以进程为单位调用。
用户级线程由应用进行切换。
2. 内核线程
操作系统能调度的线程，也是操作系统能看到的线程，由内核管理和切换。内核线程才是机器分配时间片的基本单元。

例如我们定义了10个用户线程，但内核只生成了两个内核线程来对应10个用户线程，这样，即便在一个16核的CPU上，同时最多只会有2个用户线程同时运行。类似于虽然有十个人，但是只有两条路。

# 多线程模型
用户级线程与内核线程的映射关系，就是多线程的模型。
1. 多对一
每个进程只对应一个核心线程，进程定义的用户级线程轮流使用这个核心线程。
性能问题，不能在多核CPU上并发。
2. 一对一
一个用户线程对应一个内核线程。
进程占用多个核心线程，线程切换（需要切换到核心态）成本很高。
3. 多对多
n个用户线程映射到m个内核线程。
是现在常用的解决方案。