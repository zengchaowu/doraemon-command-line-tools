# 操作系统运行机制

## 内核
操作系统的核心功能就是内核。（下面的是微内核）
1. 时钟管理
2. 中断处理 负责实现中断机制
3. 原语，一种特殊的程序，最接近硬件，这种程序调用频繁但是时间很短，并且是原子执行（不能被中断）。（设备驱动，CPU切换）
内核中上层部分
进程管理，存储器管理和设备管理。（这个在部分操作系统中不算内核）

大内核：
将上面的模块都作为系统内核，运行在核心态。这样性能很高，因为不需要频繁切换CPU状态。
微内核：
只把核心功能作为内核，进程管理之类的运行在用户态。需要频繁切换CPU状态。但是内核功能少，结构清晰，容易维护。


## CPU两种状态
用户态和内核态
CPU处于用户态，就不能执行特权指令。
处于核心态，则不受限制。而这个状态是操作系统利用程序状态字寄存器PSW实现的，其中的某一个bit用来表示用户态或者核心态。

## 两种指令
1. 特权指令 不允许普通用户执行
实际是通过CPU状态来控制的。普通用户在用户态下执行指令。
2. 非特权指令

## 两种程序
1. 内核程序
操作系统的管理者，运行时，CPU是核心态。
2. 应用程序
运行在用户态。